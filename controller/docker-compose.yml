version: '3.8'

services:
  pn-controller:
    build: .
    container_name: pn-controller
    network_mode: host  # Required for raw sockets and DCP multicast
    privileged: true    # Required for raw socket access
    environment:
      # DEVICE_IP must be set from DCP discovery - no hardcoded defaults
      # Use POST /api/v1/discover/rtu to find devices on network
      - DEVICE_IP=${DEVICE_IP:?DEVICE_IP required - get from DCP discovery}
      - INTERFACE=${INTERFACE:-eth0}
    command: python3 pn_scapy_controller.py ${INTERFACE:-eth0} ${DEVICE_IP}
    volumes:
      - ./:/app:ro
